"use strict";angular.module("site",["ui.router","ui.bootstrap"]).config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"}).state("demo1",{url:"/demo1",templateUrl:"app/demo1/demo.html",controller:"Demo1Ctrl"}).state("demo2",{url:"/demo2",templateUrl:"app/demo2/demo.html",controller:"Demo2Ctrl"}),o.otherwise("/")}]),angular.module("site").controller("MainCtrl",["$scope",function(e){e.awesomeThings=[]}]),angular.module("site").controller("Demo1Ctrl",["$scope","$filter",function(e,o){e.startDate="",e.endDate="",e.format="EEE dd-MMM-yyyy",e.open=function(o,n){o.preventDefault(),o.stopPropagation(),"start"===n?e.stateOpened=!0:e.endOpened=!0},e.validDates=!1,e.checkDates=function(){if(e.startDate<=e.endDate){e.validDates=!0;for(var n=e.startDate.getTime()-e.startDate.getMilliseconds(),t=864e5,c=e.endDate.getTime()-e.endDate.getMilliseconds();c>=n;n+=t)e.dayRecords.push(new a(o("date")(new Date(n),"EEE dd-MMM-yyyy")))}},e.getStateJSON=function(){var o={startDate:e.startDate,endDate:e.endDate,dayRecords:e.dayRecords};return JSON.stringify(o)},e.loadFromFile=function(o){var n=JSON.parse(o);null!==n&&(e.startDate=n.startDate,e.endDate=n.endDate,e.dayRecords=n.dayRecords,e.validDates=!0)},e.downloadFile=function(){var n=e.getStateJSON(),t=o("date")(e.startDate,"dd-MMM-yyyy"),a=o("date")(e.endDate,"dd-MMM-yyyy"),c=t+"_"+a+".demo1.bkr",s=document.createElement("a");s.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(n)),s.setAttribute("download",c),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)},e.autoSaveLocalStorage=function(){};var n=function(){return{date:"",name:"",price:0,checked:!0}},t=function(e){var o={name:e,incomeItems:[new n],expenseItems:[new n]};return o};e.addIncomeItem=function(e){e.incomeItems.push(new n)},e.addExpenseItem=function(e){e.expenseItems.push(new n)},e.totalIncome=function(e){var o,n=0;for(o in e.incomeItems){var t=e.incomeItems[o];t.checked&&(n+=Number(t.price))}return n},e.totalExpense=function(e){var o,n=0;for(o in e.expenseItems){var t=e.expenseItems[o];t.checked&&(n+=Number(t.price))}return n},e.totalBalance=function(o){return e.totalIncome(o)-e.totalExpense(o)};var a=function(e){return{name:e,groups:[new t("Eat-in Cash"),new t("Delivery Cash"),new t("Just Eat Cash"),new t("Eat-in Card"),new t("Delivery Card"),new t("Just Eat Card"),new t("Eat-in Cheque"),new t("Delivery Cheque"),new t("Other")]}};e.dayRecords=[]}]).directive("onReadFile",["$parse",function(e){return{restrict:"A",scope:!1,link:function(o,n,t){var a=e(t.onReadFile);n.on("change",function(e){var n=new window.FileReader;n.onload=function(e){o.$apply(function(){a(o,{$fileContent:e.target.result})})},n.readAsText((e.srcElement||e.target).files[0])})}}}]).filter("groupTotalIncome",function(){return function(e,o){return o.totalIncome(e)}}).filter("dayTotalIncome",function(){return function(e,o){var n,t=0;for(n in e.groups){var a=e.groups[n];t+=o.totalIncome(a)}return t}}).filter("groupTotalExpense",function(){return function(e,o){return o.totalExpense(e)}}).filter("dayTotalExpense",function(){return function(e,o){var n,t=0;for(n in e.groups){var a=e.groups[n];t+=o.totalExpense(a)}return t}}).filter("groupTotalBalance",function(){return function(e,o){return o.totalBalance(e)}}).filter("dayTotalBalance",function(){return function(e,o){var n,t=0;for(n in e.groups){var a=e.groups[n];t+=o.totalBalance(a)}return t}}),angular.module("site").controller("Demo2Ctrl",["$scope",function(e){e.items=[],e.groups={income:[],expense:[]}}]),angular.module("site").run(["$templateCache",function(e){e.put("app/demo1/demo.html",'<div class="container"><div class="row" ng-show="!validDates"><div class="col-md-6">Start Date</div><div class="col-md-6">End Date</div><div class="col-md-6"><p class="input-group"><input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="startDate" is-open="stateOpened" close-text="Close"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open($event, \'start\')"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div><div class="col-md-6"><p class="input-group"><input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="endDate" is-open="endOpened" close-text="Close"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open($event, \'end\')"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div><button type="button" class="btn btn-primary col-md-4" ng-click="checkDates()">Confirm Start and End Dates</button><div class="col-md-2"></div><div class="col-md-2">Upload Record:</div><input type="file" class="col-md-4" value="Upload Records" on-read-file="loadFromFile($fileContent)"></div><div ng-show="validDates"><button type="button" class="btn btn-primary" ng-click="downloadFile()">Download</button><accordion close-others="false"><accordion-group is-open="dayStatus.open" ng-repeat="dayRecord in dayRecords"><accordion-heading><div class="row"><span class="col-md-2">{{ dayRecord.name }}</span> <span class="col-md-3">Income: {{ dayRecord | dayTotalIncome:this }}</span> <span class="col-md-3">Expense: {{ dayRecord | dayTotalExpense:this }}</span> <span class="col-md-3">Balance: {{ dayRecord | dayTotalBalance:this }}</span> <i class="col-md-1 pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': dayStatus.open, \'glyphicon-chevron-right\': !dayStatus.open}"></i></div></accordion-heading><div class="col-md-12 row"><div class="col-md-12"><accordion close-others="false"><accordion-group is-open="groupStatus.open" ng-repeat="group in dayRecord.groups"><accordion-heading><div class="row"><span class="col-md-2">{{ group.name }}</span> <span class="col-md-3">Income: {{ group | groupTotalIncome:this }}</span> <span class="col-md-3">Expense: {{ group | groupTotalExpense:this }}</span> <span class="col-md-3">Balance: {{ group | groupTotalBalance:this }}</span> <i class="col-md-1 pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': groupStatus.open, \'glyphicon-chevron-right\': !groupStatus.open}"></i></div></accordion-heading><div class="col-md-12 row"><div class="col-md-2"></div><div class="col-md-4 row"><div class="col-md-12 row" ng-repeat="item in group.incomeItems"><div class="input-group col-md-12 row"><span class="input-group-addon"><input type="checkbox" ng-model="item.checked"></span> <input type="text" placeholder="Item Name" class="form-control" ng-model="item.name"></div><div class="input-group col-md-12 row"><label class="col-md-4">Price:</label> <input type="text" placeholder="0.00" class="col-md-8" ng-model="item.price"></div></div><div class="col-md-12 glyphicon glyphicon-plus" ng-click="group.addIncomeItem()"></div></div><div class="col-md-4 row"><div class="col-md-12 row" ng-repeat="item in group.expenseItems"><div class="input-group col-md-12 row"><span class="input-group-addon"><input type="checkbox" ng-model="item.checked"></span> <input type="text" placeholder="Item Name" class="form-control" ng-model="item.name"></div><div class="input-group col-md-12 row"><label class="col-md-4">Price:</label> <input type="text" placeholder="0.00" class="col-md-8" ng-model="item.price"></div></div><div class="col-md-12 glyphicon glyphicon-plus" ng-click="group.addExpenseItem()"></div></div><div class="col-md-3 row"></div></div></accordion-group></accordion></div></div></accordion-group></accordion></div></div>'),e.put("app/demo2/demo.html",'<div class="container"><div class="row" ng-show="!validDates"><div class="col-md-6">Start Date</div><div class="col-md-6">End Date</div><div class="col-md-6"><p class="input-group"><input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="startDate" is-open="stateOpened" close-text="Close"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open($event, \'start\')"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div><div class="col-md-6"><p class="input-group"><input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="endDate" is-open="endOpened" close-text="Close"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open($event, \'end\')"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div><button type="button" class="btn btn-primary" ng-click="checkDates()">Confirm Start and End Dates</button></div><div ng-show="validDates"><accordion close-others="false"><accordion-group is-open="dayStatus.open" ng-repeat="dayRecord in dayRecords"><accordion-heading><div class="row"><span class="col-md-2">{{ dayRecord.name }}</span> <span class="col-md-3">Income: {{ dayRecord | dayTotalIncome }}</span> <span class="col-md-3">Expense: {{ dayRecord | dayTotalExpense }}</span> <span class="col-md-3">Balance: {{ dayRecord | dayTotalBalance }}</span> <i class="col-md-1 pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': dayStatus.open, \'glyphicon-chevron-right\': !dayStatus.open}"></i></div></accordion-heading><div class="col-md-12 row"><div class="col-md-12"><accordion close-others="false"><accordion-group is-open="groupStatus.open" ng-repeat="group in dayRecord.groups"><accordion-heading><div class="row"><span class="col-md-2">{{ group.name }}</span> <span class="col-md-3">Income: {{ group | groupTotalIncome }}</span> <span class="col-md-3">Expense: {{ group | groupTotalExpense }}</span> <span class="col-md-3">Balance: {{ group | groupTotalBalance }}</span> <i class="col-md-1 pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': groupStatus.open, \'glyphicon-chevron-right\': !groupStatus.open}"></i></div></accordion-heading><div class="col-md-12 row"><div class="col-md-2"></div><div class="col-md-4 row"><div class="col-md-12 row" ng-repeat="item in group.incomeItems"><div class="input-group col-md-12 row"><span class="input-group-addon"><input type="checkbox" ng-model="item.checked"></span> <input type="text" placeholder="Item Name" class="form-control" ng-model="item.name"></div><div class="input-group col-md-12 row"><label class="col-md-4">Price:</label> <input type="text" placeholder="0.00" class="col-md-8" ng-model="item.price"></div></div><div class="col-md-12 glyphicon glyphicon-plus" ng-click="group.addIncomeItem()"></div></div><div class="col-md-4 row"><div class="col-md-12 row" ng-repeat="item in group.expenseItems"><div class="input-group col-md-12 row"><span class="input-group-addon"><input type="checkbox" ng-model="item.checked"></span> <input type="text" placeholder="Item Name" class="form-control" ng-model="item.name"></div><div class="input-group col-md-12 row"><label class="col-md-4">Price:</label> <input type="text" placeholder="0.00" class="col-md-8" ng-model="item.price"></div></div><div class="col-md-12 glyphicon glyphicon-plus" ng-click="group.addExpenseItem()"></div></div><div class="col-md-3 row"></div></div></accordion-group></accordion></div></div></accordion-group></accordion></div></div>'),e.put("app/main/main.html",'<div class="container"><a ui-sref="demo1">Demo 1</a><br><a ui-sref="demo2">Demo 2</a></div>')}]);